{% extends 'base.html.twig' %}

{% block title %}Espace utilisateur{% endblock %}

{% block body %}

{% include "user/_sectionBanner.html.twig" %}

<!-- START PROJECT AREA CONTENT -->
<section class="bg-light costom-padding-style2">
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<div class="d-block">
					<!-- Nav pills -->
					<ul class="nav nav-tabs">
						<li class="nav-item">
							<a class="nav-link active" data-toggle="pill" href="#profile">Profil Utilisateur</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" data-toggle="pill" href="#financement">Financements</a>
						</li>
					</ul>

					<!-- Tab panes -->
					<div class="tab-content bg-white pt-2 border">
						<div class="tab-pane container active" id="profile">

                            <div class="dr">
                                <h4 class="mt-4 mb-4 float-md-left">Informations sur votre profil</h4>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-striped table-borderless user-financement">
                                    <tbody>
                                        <tr>
                                            <th>Nom</th>
                                            <td>
                                                <strong class="font-weight-bold float-md-left">{{ user.nom }}</strong>
                                                <a href="{{ path('app_user_edit_profile') }}" class="text-primary float-md-right"><i class="fa fa-edit"></i> Modifier</a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <th>Email</th>
                                            <td>{{ user.email }}</td>
                                        </tr>
                                        <tr>
                                            <th>Role</th>
                                            <td>
                                                {% for role in user.roles %}
                                                    <span class="badge p-0">
                                                        {% if role == "ROLE_USER"%}<i class="fa fa-user"></i>
                                                            Utilisateur
                                                        {% endif %}
                                                    </span>
                                                {% endfor %}
                                            </td>
                                        </tr>
                                        <tr>
                                            <th>Statut du compte</th>
                                            <td>
                                                <span class="badge badge-{{ user.isVerified ? 'success' : 'danger' }}">
                                                    {{ user.isVerified ? 'Actif' : 'Non activé' }}
                                                </span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <th>Dernière mise à jour</th>
                                            <td>{{ user.updated ? user.updated|date('d/m/Y à H:i:s') : '' }}</td>
                                        </tr>

                                    </tbody>
                                </table>
                            </div>
						</div>

						<div class="tab-pane container fade" id="financement">
							<div class="p-2">

                                <h4 class="mt-4 mb-4">Vos dernières transactions financières</h4>
                                <div class="table-responsive">
                                    <table class="table table-striped table-borderless user-financement">
                                        <thead>
                                            <tr style="border-bottom: 1px solid green;">
                                                <th> <i class="fa fa-calendar text-secondary"></i> Date</th>
                                                <th>Montant</th>
                                                <th>Projet</th>
                                                <th>Statut</th>
                                                <th class="text-center">Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            
                                            {% for financement in user.financements() %}

                                                <!-- if is_granted('app_auteur_du_financement', financement) %}-->
                                                <tr class="col-md-4">
                    
                                                    <td>{{ financement.created|date('d/m/Y') }}</td>
                                                    <td>
                                                        <span class="badge montant">{{ financement.montant|number_format(2, ' ', ' ') ~ currency }}</span></td>
                                                    <td>{{ financement.projet.name|u.truncate(30, '...') }}  {{ financement.user.nom }}</td>
                                                    <td><span class="badge badge-{{ financement.statut == 1 ? 'success' : 'danger'}}">{{ financement.statut == 1 ? 'réussi' : 'échoué'}}</span></td>
                                                    <td class="text-center">
                                                        <button type="button" class="btn" data-toggle="modal" data-target="#financemenDetail-{{ financement.id }}">
                                                          <i class="fa fa-ellipsis-h"></i>
                                                        </button>

                                                        {% include "user/_financementBlocDetail.html.twig" %}
                                                    </td>
                                                </tr>
                                                <!-- endif %} -->
                                            {% else %}
                                                <tr>
                                                    <td colspan="5">Vous n'avez éffectuez aucun financement</td>
                                                </tr>
                                            {% endfor %}

                                        </tbody>
                                    </table>
                                </div>
                                <!-- knp_pagination_render(user.financements()) }}-->
                            </div>
						</div>

					</div>
				</div>
			</div>
		</div>
	</div>
</section>
<!-- END PROJECT AREA CONTENT -->
    
{% endblock %}
